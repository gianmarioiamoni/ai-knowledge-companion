# Vercel Deploy Checklist

## âœ… Pre-Deploy Verification

### 1. **Environment Variables** (da configurare su Vercel)
- [ ] `NEXT_PUBLIC_SUPABASE_URL`
- [ ] `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- [ ] `SUPABASE_SERVICE_ROLE_KEY`
- [ ] `OPENAI_API_KEY`
- [ ] `NEXTAUTH_SECRET` (generate with: `openssl rand -base64 32`)
- [ ] `NEXTAUTH_URL` (es: https://yourdomain.vercel.app)
- [ ] `NEXT_PUBLIC_SITE_URL` (stesso di NEXTAUTH_URL)
- [ ] `BOOTSTRAP_SECRET` (generate with: `openssl rand -base64 32`)
- [ ] `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY`
- [ ] `STRIPE_SECRET_KEY`
- [ ] `STRIPE_WEBHOOK_SECRET`
- [ ] `STRIPE_PRICE_PRO_MONTHLY`
- [ ] `STRIPE_PRICE_PRO_YEARLY`
- [ ] `STRIPE_PRICE_ENTERPRISE_MONTHLY`
- [ ] `STRIPE_PRICE_ENTERPRISE_YEARLY`
- [ ] `UPSTASH_REDIS_REST_URL`
- [ ] `UPSTASH_REDIS_REST_TOKEN`

### 2. **Build Configuration**
- [ ] Build command: `npm run build`
- [ ] Output directory: `.next`
- [ ] Install command: `npm install`
- [ ] Node version: `20.x`

### 3. **Domain Configuration**
- [ ] Main domain configured
- [ ] SSL/HTTPS enabled
- [ ] Update NEXTAUTH_URL dopo setup dominio
- [ ] Update NEXT_PUBLIC_SITE_URL dopo setup dominio

### 4. **Supabase Configuration**
- [ ] Add Vercel domain to Supabase Auth "Site URL"
- [ ] Add Vercel domain to Supabase Auth "Redirect URLs"
- [ ] Example: https://yourdomain.vercel.app/**

### 5. **Stripe Configuration**
- [ ] Create products in Stripe Dashboard (Production mode)
- [ ] Get Production price IDs
- [ ] Configure webhook endpoint: https://yourdomain.vercel.app/api/webhooks/stripe
- [ ] Get webhook secret and update STRIPE_WEBHOOK_SECRET

### 6. **Post-Deploy Steps**
- [ ] Run super admin bootstrap: POST https://yourdomain.vercel.app/api/admin/bootstrap
- [ ] Test authentication flow
- [ ] Test subscription flow
- [ ] Test file uploads
- [ ] Test chat/RAG functionality
- [ ] Verify rate limiting works

### 7. **Monitoring**
- [ ] Enable Vercel Analytics
- [ ] Configure error tracking (optional: Sentry)
- [ ] Monitor function logs
- [ ] Check Edge Function performance

## ðŸ”„ **Continuous Deployment**

### Production (main branch)
```bash
git checkout main
git merge develop
git push origin main
```
â†’ Automatic deployment to production

### Staging (develop branch)
```bash
git checkout develop
git merge feature/your-feature
git push origin develop
```
â†’ Automatic deployment to preview

## ðŸš¨ **Important Notes**

1. **Never commit `.env` or `.env.local` files**
2. **Always test on preview deployment before merging to main**
3. **Use environment-specific Stripe keys** (test vs production)
4. **Backup database before major deployments**
5. **Monitor Vercel function logs** for errors after deployment

## ðŸ“š **Useful Commands**

```bash
# Generate secrets
openssl rand -base64 32

# Test build locally
npm run build

# Test production build locally
npm run start

# Check for type errors
npx tsc --noEmit

# Check for linting issues
npm run lint
```

## ðŸ”— **Useful Links**

- Vercel Dashboard: https://vercel.com/dashboard
- Supabase Dashboard: https://supabase.com/dashboard
- Stripe Dashboard: https://dashboard.stripe.com
- Upstash Console: https://console.upstash.com

